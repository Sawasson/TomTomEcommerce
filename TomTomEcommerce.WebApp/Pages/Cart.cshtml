@page
@model TomTomEcommerce.WebApp.Pages.CartModel
@{
}
@using TomTomEcommerce.BackOffice;

<div class="cart_area section_padding_100 clearfix">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="cart-table clearfix">
                    <div id="cartProductListArea">

                    </div>
                </div>

                <div class="cart-footer d-flex mt-30">
                    <div class="back-to-shop w-50">
                        <a href="shop-grid-left-sidebar.html">Continue shooping</a>
                    </div>
                    <div class="update-checkout w-50 text-right">
                        <a href="#" id="clearCart">clear cart</a>
                    </div>
                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-12 col-md-6 col-lg-4">
                <div class="coupon-code-area mt-70">
                    <div class="cart-page-heading">
                        <h5>Cupon code</h5>
                        <p>Enter your cupone code</p>
                    </div>
                    <form action="#">
                        <input type="search" name="search" placeholder="#569ab15">
                        <button type="submit">Apply</button>
                    </form>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-4">
                <div class="shipping-method-area mt-70">
                    <div class="cart-page-heading">
                        <h5>Shipping method</h5>
                        <p>Select the one you want</p>
                    </div>

                    <div class="custom-control custom-radio mb-30">
                        <input type="radio" id="customRadio1" name="customRadio" class="custom-control-input">
                        <label class="custom-control-label d-flex align-items-center justify-content-between" for="customRadio1"><span>Next day delivery</span><span>$4.99</span></label>
                    </div>

                    <div class="custom-control custom-radio mb-30">
                        <input type="radio" id="customRadio2" name="customRadio" class="custom-control-input">
                        <label class="custom-control-label d-flex align-items-center justify-content-between" for="customRadio2"><span>Standard delivery</span><span>$1.99</span></label>
                    </div>

                    <div class="custom-control custom-radio">
                        <input type="radio" id="customRadio3" name="customRadio" class="custom-control-input">
                        <label class="custom-control-label d-flex align-items-center justify-content-between" for="customRadio3"><span>Personal Pickup</span><span>Free</span></label>
                    </div>
                </div>
            </div>
            <div class="col-12 col-lg-4">
                <div class="cart-total-area mt-70">
                    <div class="cart-page-heading">
                        <h5>Cart total</h5>
                        <p>Final info</p>
                    </div>

                    <ul class="cart-total-chart">
                        @{ 
                            double totalPrice = 0;
                            foreach (var item in Model.CartProducts)
                            {
                                double cartProductTotal = item.Product.Price * item.Quantity;
                                totalPrice = totalPrice + cartProductTotal;
                            }
                        }

                            <li><span>Subtotal</span> <span>$@totalPrice</span></li>
                            <li><span>Shipping</span> <span>Free</span></li>
                            <li><span><strong>Total</strong></span> <span><strong>$@totalPrice</strong></span></li>
                        </ul>
                    <a href="checkout.html" class="btn karl-checkout-btn">Proceed to checkout</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>


<script>
    $(document).ready(function () {

        //GET - LIST CARTPRODUCT

        $.ajax({
            type: 'GET',
            url: '@Url.Page("Cart", "CartProductList")',
            success: function (data) {
                $("#cartProductListArea").html(data);
            }
        });



        //POST - CLEAR CART

        $("#clearCart").click(function () {
            myFunction();
        });

            function myFunction() {
            var txt;
            if (confirm("Are you clear your cart?")) {
                txt = "You pressed OK!";
                                var token = '@HttpContext.GetAntiforgeryToken()';

                $.ajax({
                    type: 'POST',
                    url: '@Url.Page("Cart", "ClearCart")',
                    success: function (data) {
                        alert("success");
                        $("#cartProductListArea").html("");
                        $("#cartProductListArea").html(data);
                        //$.validator.unobtrusive.parse($("#modaldiv"));
                        //    debugger;
                    },
                    headers:
                    {
                        "RequestVerificationToken": token
                    }


                });

            } else {
                txt = "You pressed Cancel!";
            }
        }






    });
</script>